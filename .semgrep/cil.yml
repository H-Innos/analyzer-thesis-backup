rules:
  - id: cilfacade
    pattern-either:
      - pattern: Cil.typeOf
      - pattern: Cil.typeOfLval
      - pattern: Cil.typeOfInit
      - pattern: Cil.typeOffset
      - pattern: Cil.mkCast
      - pattern: Cil.get_stmtLoc
      - pattern: Cil.get_instrLoc
    paths:
      exclude:
        - cilfacade0.ml
        - cilfacade.ml
    message: use Cilfacade instead
    languages: [ocaml]
    severity: WARNING

  - id: typsig-equal
    pattern: typeSig $X = typeSig $Y
    fix: CilType.Typ.equal $X $Y
    message: use direct comparison instead
    languages: [ocaml]
    severity: WARNING

  - id: typsig-not-equal
    pattern: typeSig $X <> typeSig $Y
    fix: not (CilType.Typ.equal $X $Y)
    message: use direct comparison instead
    languages: [ocaml]
    severity: WARNING
